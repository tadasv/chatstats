<html>
    <body>
        <div id="placeholder" style="width:600px;height:300px"></div>
        <div id="graph2" style="width:600px;height:300px"></div>
    </body>
    <script src="../js/jquery/jquery-1.6.3.js" type="text/javascript"></script>
    <script src="../js/jquery/flot/jquery.flot.js" type="text/javascript"></script>
    <script src="../js/jquery/jquery.flot.pie.js" type="text/javascript"></script>

<script>
    /*
 * -Get data from MongoDB
 * -Turn into flot-friendly data
 * -plot that shit
 *
 */
/*
var testData = {
    "speakersnames" : ["af", "hf", "ak", "ll"],
    "speakerstats" : [
    { "name": "af", "stats" : {"vb" : 14, "total": 139, "rt": 71} },
    { "name": "af", "stats" : {"hf" : "vb" : 12, "total": 535, "rt": 21} },
    { "name": "af", "stats" : {"ak" : "vb" : 31, "total": 159, "rt": 14} },
    { "name": "af", "stats" : {"ll" : "vb" : 26, "total": 333, "rt": 4}}
    ]
};
*/

var testData = {
    "dataName" : "frequency/rawtotal/verbose",
    "data" : { "af" : 23, "hw" : 44, "ta" : 32}
};


var sampleData = {
        pieData : [
            {label: "name1", data : 12},
            {label: "name2", data : 15},
            {label: "name3", data : 18},
            {label: "name4", data : 21},
            {label: "name5", data : 24},
            {label: "name6", data : 27}
        ],
        barData : [
            {label: "name1", data : 12},
            {label: "name2", data : 15},
            {label: "name3", data : 18},
            {label: "name4", data : 21},
            {label: "name5", data : 24},
            {label: "name6", data : 27}
        ]
};

$(function () {
    /*
     * Settings
     */
    var updateInterval = 4000; //4 second updates

    //options for flot
    var pieOptions = {
        series : { pie: {show:true,
                                       radius: 1,
                                       label : {show:true,
                                                radius: 1}}},
        legend : {show:false}
    };

    var barOptions = {
        series: {
                bars: { show: bars, barWidth: 0.6 }
            }
    }

    /*
     * End Settings
     */

    function getData(graphType){
        //JSON retrieval
        //dataToPlot = //interpretation of Json
        //will want to iterate over api calls and construct a large list of all 3?
        //assuming data is pre-sorted

        //temp test
        /*
        var flotData = [];
        console.log("getData");
        console.log(testData);
        console.log(testData.dataName);
        console.log(testData.data);
        for( var key in testData.data ){
            var name = key;
            var value = testData.data[key];
            console.log(name, value);
            flotData.push([name, value])
        }
        console.log(flotData);
        */
        console.log(sampleData.pieData);

        if(graphType == "pie"){
            return sampleData.pieData;
        }

        if(graphType == "bar"){
            return sampleData.barData;
        }
    }

    function update(){
        plot.setData(getData());
        //plot.setupGrid();
        plot.draw()
        console.log("update");

        setTimeout(update, updateInterval);
    }

    //update();
    getData();
    console.log("asdf");
    var plot1 = $.plot($("#placeholder"), getData("pie"), pieOptions);
    var plot2 = $.plot($("#graph2"), getData("bar"), barOptions);
    plot1.draw();
    plot2.draw();
    update();

    });
</script>
</html>

